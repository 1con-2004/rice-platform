<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>用户管理 - 智慧农业溯源管理后台</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="../assets/styles.css" rel="stylesheet">
    <style>
        .admin-layout {
            background: #f8fafc;
            min-height: 100vh;
        }
        
        .admin-header {
            background: linear-gradient(135deg, #1e293b, #334155);
            color: white;
            padding: 16px 24px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .admin-nav {
            background: white;
            border-bottom: 1px solid #e2e8f0;
            padding: 0 24px;
            display: flex;
            align-items: center;
            gap: 32px;
            overflow-x: auto;
        }
        
        .nav-item {
            padding: 16px 0;
            border-bottom: 2px solid transparent;
            color: #64748b;
            text-decoration: none;
            white-space: nowrap;
            transition: all 0.2s ease;
        }
        
        .nav-item.active {
            color: #7c3aed;
            border-bottom-color: #7c3aed;
        }
        
        .user-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            margin-bottom: 20px;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        
        .user-card:hover {
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.12);
        }
        
        .user-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, #16a34a, #059669);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            font-weight: bold;
            margin-right: 16px;
            flex-shrink: 0;
        }
        
        .status-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .status-active {
            background: #dcfce7;
            color: #16a34a;
        }
        
        .status-inactive {
            background: #fee2e2;
            color: #dc2626;
        }
        
        .status-support {
            background: #fef3c7;
            color: #d97706;
        }
        
        .status-new {
            background: #dbeafe;
            color: #2563eb;
        }
        
        .action-btn {
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            border: none;
            margin-right: 8px;
        }
        
        .btn-call {
            background: #10b981;
            color: white;
        }
        
        .btn-call:hover {
            background: #059669;
        }
        
        .btn-edit {
            background: #3b82f6;
            color: white;
        }
        
        .btn-edit:hover {
            background: #2563eb;
        }
        
        .btn-disable {
            background: #ef4444;
            color: white;
        }
        
        .btn-disable:hover {
            background: #dc2626;
        }
        
        .btn-enable {
            background: #f59e0b;
            color: white;
        }
        
        .btn-enable:hover {
            background: #d97706;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 32px;
        }
        
        .stat-card {
            background: white;
            padding: 24px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            text-align: center;
        }
        
        .stat-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 16px;
            font-size: 20px;
        }
        
        .filter-bar {
            background: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 24px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        }
        
        .info-incomplete {
            background: #fef3c7;
            border-left: 4px solid #f59e0b;
            padding: 12px 16px;
            border-radius: 0 8px 8px 0;
            margin: 12px 0;
        }
        
        .info-complete {
            background: #dcfce7;
            border-left: 4px solid #16a34a;
            padding: 12px 16px;
            border-radius: 0 8px 8px 0;
            margin: 12px 0;
        }
        
        .help-request {
            background: #fce7f3;
            border-left: 4px solid #be185d;
            padding: 12px 16px;
            border-radius: 0 8px 8px 0;
            margin: 12px 0;
        }
        
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .modal-overlay.show {
            opacity: 1;
            visibility: visible;
        }
        
        .modal-content {
            background: white;
            border-radius: 16px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            transform: scale(0.9);
            transition: transform 0.3s ease;
        }
        
        .modal-overlay.show .modal-content {
            transform: scale(1);
        }
        
        .call-status {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 500;
            margin-left: 8px;
        }
        
        .call-success {
            background: #dcfce7;
            color: #16a34a;
        }
        
        .call-failed {
            background: #fee2e2;
            color: #dc2626;
        }
        
        .call-pending {
            background: #fef3c7;
            color: #d97706;
        }
        
        .crop-tag {
            display: inline-block;
            background: #f0fdf4;
            color: #16a34a;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 11px;
            margin-right: 6px;
            margin-bottom: 4px;
        }
        
        .progress-bar {
            height: 6px;
            background: #e5e7eb;
            border-radius: 3px;
            overflow: hidden;
            margin-top: 8px;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #16a34a, #059669);
            border-radius: 3px;
            transition: width 0.3s ease;
        }
    </style>
</head>
<body class="admin-layout">
    <!-- iOS状态栏 -->
    <div class="status-bar">
        <div class="status-left">
            <span>9:41</span>
        </div>
        <div class="status-right">
            <i class="fas fa-signal text-sm"></i>
            <i class="fas fa-wifi text-sm"></i>
            <div class="battery">
                <div class="battery-level"></div>
            </div>
        </div>
    </div>

    <!-- 管理员头部 -->
    <div class="admin-header">
        <div class="flex items-center">
            <button onclick="goBack()" class="text-white text-xl mr-4">
                <i class="fas fa-arrow-left"></i>
            </button>
            <h1 class="text-xl font-bold">智慧农业溯源管理后台</h1>
        </div>
        <div class="flex items-center gap-4">
            <span class="text-sm">管理员：张管理员</span>
            <button class="text-white hover:text-gray-300" onclick="logout()">
                <i class="fas fa-sign-out-alt"></i>
            </button>
        </div>
    </div>

    <!-- 导航栏 -->
    <div class="admin-nav">
        <a href="#" class="nav-item" onclick="switchTab('content')">
            <i class="fas fa-clipboard-check mr-2"></i>
            内容审核
        </a>
        <a href="#" class="nav-item active">
            <i class="fas fa-users mr-2"></i>
            用户管理
        </a>
        <a href="#" class="nav-item" onclick="switchTab('analytics')">
            <i class="fas fa-chart-bar mr-2"></i>
            数据统计
        </a>
        <a href="#" class="nav-item">
            <i class="fas fa-cog mr-2"></i>
            系统设置
        </a>
    </div>

    <!-- 主内容区域 -->
    <div class="p-6">
        <!-- 统计卡片 -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon bg-green-100 text-green-600">
                    <i class="fas fa-users"></i>
                </div>
                <h3 class="text-2xl font-bold text-gray-800 mb-2">1,456</h3>
                <p class="text-gray-600">总用户数</p>
                <p class="text-sm text-green-600 mt-1">+15 新增今日</p>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon bg-blue-100 text-blue-600">
                    <i class="fas fa-user-check"></i>
                </div>
                <h3 class="text-2xl font-bold text-gray-800 mb-2">1,234</h3>
                <p class="text-gray-600">活跃用户</p>
                <p class="text-sm text-blue-600 mt-1">84.7% 活跃率</p>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon bg-yellow-100 text-yellow-600">
                    <i class="fas fa-user-plus"></i>
                </div>
                <h3 class="text-2xl font-bold text-gray-800 mb-2">23</h3>
                <p class="text-gray-600">新注册用户</p>
                <p class="text-sm text-yellow-600 mt-1">待完善信息</p>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon bg-red-100 text-red-600">
                    <i class="fas fa-headset"></i>
                </div>
                <h3 class="text-2xl font-bold text-gray-800 mb-2">8</h3>
                <p class="text-gray-600">待支持用户</p>
                <p class="text-sm text-red-600 mt-1">需要帮助</p>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon bg-purple-100 text-purple-600">
                    <i class="fas fa-phone"></i>
                </div>
                <h3 class="text-2xl font-bold text-gray-800 mb-2">45</h3>
                <p class="text-gray-600">电话支持次数</p>
                <p class="text-sm text-purple-600 mt-1">本周总计</p>
            </div>
        </div>

        <!-- 筛选栏 -->
        <div class="filter-bar">
            <div class="flex flex-wrap items-center gap-4">
                <div class="flex items-center gap-2">
                    <label class="text-sm font-medium text-gray-700">用户状态：</label>
                    <select class="border border-gray-300 rounded-lg px-3 py-2 text-sm" onchange="filterUsers(this.value)">
                        <option value="all">全部用户</option>
                        <option value="active">活跃用户</option>
                        <option value="new">新注册</option>
                        <option value="support">需要支持</option>
                        <option value="inactive">不活跃</option>
                    </select>
                </div>
                
                <div class="flex items-center gap-2">
                    <label class="text-sm font-medium text-gray-700">地区：</label>
                    <select class="border border-gray-300 rounded-lg px-3 py-2 text-sm" onchange="filterByRegion(this.value)">
                        <option value="all">全部地区</option>
                        <option value="jiangsu">江苏省</option>
                        <option value="shandong">山东省</option>
                        <option value="hebei">河北省</option>
                        <option value="zhejiang">浙江省</option>
                    </select>
                </div>
                
                <div class="flex items-center gap-2">
                    <label class="text-sm font-medium text-gray-700">搜索：</label>
                    <input type="text" 
                           class="border border-gray-300 rounded-lg px-3 py-2 text-sm w-64" 
                           placeholder="搜索用户姓名、电话或账号"
                           onchange="searchUsers(this.value)">
                </div>
                
                <button class="action-btn btn-call" onclick="exportUsers()">
                    <i class="fas fa-download mr-2"></i>
                    导出用户列表
                </button>
            </div>
        </div>

        <!-- 用户列表 -->
        <div id="userList">
            <!-- 需要帮助的用户 - 优先显示 -->
            <div class="user-card">
                <div class="p-6">
                    <div class="flex items-start justify-between mb-4">
                        <div class="flex items-center">
                            <div class="user-avatar">王</div>
                            <div>
                                <div class="flex items-center mb-2">
                                    <h4 class="font-bold text-gray-800 mr-3">王大叔</h4>
                                    <span class="status-badge status-support">需要支持</span>
                                    <span class="text-sm text-red-600 ml-2 font-medium">
                                        <i class="fas fa-exclamation-triangle mr-1"></i>
                                        优先处理
                                    </span>
                                </div>
                                <div class="flex items-center text-sm text-gray-600 mb-1">
                                    <i class="fas fa-phone mr-2"></i>
                                    <span class="mr-4">138****8888</span>
                                    <i class="fas fa-map-marker-alt mr-2"></i>
                                    <span>河北省保定市</span>
                                </div>
                                <div class="flex items-center text-sm text-gray-500">
                                    <span class="mr-4">账号：wangdashu2024</span>
                                    <span>注册：2024-03-15</span>
                                </div>
                            </div>
                        </div>
                        <div class="text-right">
                            <span class="call-status call-pending">待回电</span>
                            <p class="text-xs text-gray-500 mt-1">最后活跃：2小时前</p>
                        </div>
                    </div>
                    
                    <div class="help-request">
                        <div class="flex items-start">
                            <i class="fas fa-question-circle text-pink-600 text-lg mr-3 mt-1"></i>
                            <div>
                                <h5 class="font-medium text-pink-800 mb-1">求助信息</h5>
                                <p class="text-sm text-pink-700 mb-2">
                                    用户反馈：不知道怎么上传照片，拍了照片但是找不到发布按钮。
                                    已经尝试多次但是不成功，希望能电话指导一下。
                                </p>
                                <p class="text-xs text-pink-600">
                                    求助时间：2小时前 | 联系方式：138****8888
                                </p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-sm text-gray-600">作物信息</span>
                            <span class="text-sm text-gray-500">完整度：60%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 60%"></div>
                        </div>
                        <div class="mt-2">
                            <span class="crop-tag">甜玉米</span>
                            <span class="crop-tag">5亩</span>
                            <span class="text-xs text-gray-500">缺少：种植品种详情、认证信息</span>
                        </div>
                    </div>
                    
                    <div class="flex items-center justify-between">
                        <div class="flex items-center gap-2">
                            <button class="action-btn btn-call" onclick="callUser('王大叔', '138****8888', 'support')">
                                <i class="fas fa-phone mr-1"></i>
                                立即回电
                            </button>
                            <button class="action-btn btn-edit" onclick="helpCompleteInfo('王大叔')">
                                <i class="fas fa-user-edit mr-1"></i>
                                帮助完善
                            </button>
                            <button class="action-btn" onclick="viewUserDetail('王大叔')" style="background: #6b7280; color: white;">
                                <i class="fas fa-eye mr-1"></i>
                                查看详情
                            </button>
                        </div>
                        <div class="text-xs text-gray-500">
                            <p>发布：5条记录</p>
                            <p>最后发布：1天前</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 新注册用户 -->
            <div class="user-card">
                <div class="p-6">
                    <div class="flex items-start justify-between mb-4">
                        <div class="flex items-center">
                            <div class="user-avatar" style="background: linear-gradient(135deg, #3b82f6, #2563eb);">李</div>
                            <div>
                                <div class="flex items-center mb-2">
                                    <h4 class="font-bold text-gray-800 mr-3">李农户</h4>
                                    <span class="status-badge status-new">新用户</span>
                                </div>
                                <div class="flex items-center text-sm text-gray-600 mb-1">
                                    <i class="fas fa-phone mr-2"></i>
                                    <span class="mr-4">139****6666</span>
                                    <i class="fas fa-map-marker-alt mr-2"></i>
                                    <span>山东省济南市</span>
                                </div>
                                <div class="flex items-center text-sm text-gray-500">
                                    <span class="mr-4">账号：linonghui2024</span>
                                    <span>注册：今天 14:30</span>
                                </div>
                            </div>
                        </div>
                        <div class="text-right">
                            <span class="call-status call-success">已联系</span>
                            <p class="text-xs text-gray-500 mt-1">在线</p>
                        </div>
                    </div>
                    
                    <div class="info-incomplete">
                        <div class="flex items-start">
                            <i class="fas fa-info-circle text-yellow-600 text-lg mr-3 mt-1"></i>
                            <div>
                                <h5 class="font-medium text-yellow-800 mb-1">信息待完善</h5>
                                <p class="text-sm text-yellow-700 mb-2">
                                    用户刚注册，基本信息已填写完整，但缺少作物详细信息。
                                    已电话联系，用户表示明天开始种植小麦，需要指导如何记录。
                                </p>
                                <p class="text-xs text-yellow-600">
                                    联系时间：30分钟前 | 状态：配合度高
                                </p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-sm text-gray-600">账户完整度</span>
                            <span class="text-sm text-gray-500">85%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 85%"></div>
                        </div>
                        <div class="mt-2">
                            <span class="text-xs text-gray-500">缺少：作物种植计划、种植面积</span>
                        </div>
                    </div>
                    
                    <div class="flex items-center justify-between">
                        <div class="flex items-center gap-2">
                            <button class="action-btn btn-call" onclick="callUser('李农户', '139****6666', 'guide')">
                                <i class="fas fa-phone mr-1"></i>
                                指导使用
                            </button>
                            <button class="action-btn btn-edit" onclick="helpCompleteInfo('李农户')">
                                <i class="fas fa-plus mr-1"></i>
                                补充信息
                            </button>
                        </div>
                        <div class="text-xs text-gray-500">
                            <p>发布：0条记录</p>
                            <p>预计开始：明天</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 活跃用户 -->
            <div class="user-card">
                <div class="p-6">
                    <div class="flex items-start justify-between mb-4">
                        <div class="flex items-center">
                            <div class="user-avatar">张</div>
                            <div>
                                <div class="flex items-center mb-2">
                                    <h4 class="font-bold text-gray-800 mr-3">张大爷</h4>
                                    <span class="status-badge status-active">活跃</span>
                                </div>
                                <div class="flex items-center text-sm text-gray-600 mb-1">
                                    <i class="fas fa-phone mr-2"></i>
                                    <span class="mr-4">138****6666</span>
                                    <i class="fas fa-map-marker-alt mr-2"></i>
                                    <span>江苏省扬州市</span>
                                </div>
                                <div class="flex items-center text-sm text-gray-500">
                                    <span class="mr-4">账号：zhangdaye2024</span>
                                    <span>注册：2024-02-10</span>
                                </div>
                            </div>
                        </div>
                        <div class="text-right">
                            <span class="call-status call-success">沟通良好</span>
                            <p class="text-xs text-gray-500 mt-1">30分钟前活跃</p>
                        </div>
                    </div>
                    
                    <div class="info-complete">
                        <div class="flex items-start">
                            <i class="fas fa-check-circle text-green-600 text-lg mr-3 mt-1"></i>
                            <div>
                                <h5 class="font-medium text-green-800 mb-1">信息完整，表现优秀</h5>
                                <p class="text-sm text-green-700 mb-2">
                                    用户非常配合，信息完整，发布记录规律。已成为平台优质用户，
                                    获得1.2k买家关注。可作为新用户学习的榜样。
                                </p>
                                <p class="text-xs text-green-600">
                                    最后联系：1周前 | 状态：自主运营良好
                                </p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-sm text-gray-600">作物管理</span>
                            <span class="text-sm text-green-600">优秀 100%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 100%"></div>
                        </div>
                        <div class="mt-2">
                            <span class="crop-tag">优质水稻</span>
                            <span class="crop-tag">15亩</span>
                            <span class="crop-tag">有机认证</span>
                            <span class="text-xs text-green-600 ml-2">第89天 · 记录完整</span>
                        </div>
                    </div>
                    
                    <div class="flex items-center justify-between">
                        <div class="flex items-center gap-2">
                            <button class="action-btn btn-call" onclick="callUser('张大爷', '138****6666', 'routine')">
                                <i class="fas fa-phone mr-1"></i>
                                常规回访
                            </button>
                            <button class="action-btn" onclick="viewUserDetail('张大爷')" style="background: #6b7280; color: white;">
                                <i class="fas fa-chart-line mr-1"></i>
                                查看数据
                            </button>
                        </div>
                        <div class="text-xs text-gray-500">
                            <p>发布：12条记录</p>
                            <p>关注：1.2k人</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 不活跃用户 -->
            <div class="user-card">
                <div class="p-6">
                    <div class="flex items-start justify-between mb-4">
                        <div class="flex items-center">
                            <div class="user-avatar" style="background: linear-gradient(135deg, #ef4444, #dc2626);">陈</div>
                            <div>
                                <div class="flex items-center mb-2">
                                    <h4 class="font-bold text-gray-800 mr-3">陈农户</h4>
                                    <span class="status-badge status-inactive">不活跃</span>
                                </div>
                                <div class="flex items-center text-sm text-gray-600 mb-1">
                                    <i class="fas fa-phone mr-2"></i>
                                    <span class="mr-4">136****9999</span>
                                    <i class="fas fa-map-marker-alt mr-2"></i>
                                    <span>浙江省杭州市</span>
                                </div>
                                <div class="flex items-center text-sm text-gray-500">
                                    <span class="mr-4">账号：chennonghui</span>
                                    <span>注册：2024-01-20</span>
                                </div>
                            </div>
                        </div>
                        <div class="text-right">
                            <span class="call-status call-failed">联系困难</span>
                            <p class="text-xs text-gray-500 mt-1">7天未活跃</p>
                        </div>
                    </div>
                    
                    <div style="background: #fef2f2; border-left: 4px solid #ef4444; padding: 12px 16px; border-radius: 0 8px 8px 0; margin: 12px 0;">
                        <div class="flex items-start">
                            <i class="fas fa-exclamation-circle text-red-600 text-lg mr-3 mt-1"></i>
                            <div>
                                <h5 class="font-medium text-red-800 mb-1">需要重新激活</h5>
                                <p class="text-sm text-red-700 mb-2">
                                    用户已7天未登录，最后一次发布是15天前。多次电话联系无法接通，
                                    可能是农忙季节。建议发送短信提醒并安排适当时间再次联系。
                                </p>
                                <p class="text-xs text-red-600">
                                    最后联系：3天前 | 状态：电话无人接听
                                </p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-sm text-gray-600">活跃度</span>
                            <span class="text-sm text-red-600">低 25%</span>
                        </div>
                        <div class="progress-bar">
                            <div style="height: 100%; background: #ef4444; border-radius: 3px; width: 25%; transition: width 0.3s ease;"></div>
                        </div>
                        <div class="mt-2">
                            <span class="crop-tag" style="background: #fee2e2; color: #dc2626;">蔬菜</span>
                            <span class="text-xs text-gray-500">最后发布：15天前</span>
                        </div>
                    </div>
                    
                    <div class="flex items-center justify-between">
                        <div class="flex items-center gap-2">
                            <button class="action-btn btn-call" onclick="callUser('陈农户', '136****9999', 'reactivate')">
                                <i class="fas fa-phone mr-1"></i>
                                重新联系
                            </button>
                            <button class="action-btn btn-enable" onclick="sendSMSReminder('陈农户')">
                                <i class="fas fa-sms mr-1"></i>
                                短信提醒
                            </button>
                            <button class="action-btn btn-disable" onclick="deactivateUser('陈农户')">
                                <i class="fas fa-pause mr-1"></i>
                                暂停账户
                            </button>
                        </div>
                        <div class="text-xs text-gray-500">
                            <p>发布：3条记录</p>
                            <p>最后：15天前</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 分页 -->
        <div class="flex items-center justify-between mt-8">
            <div class="text-sm text-gray-500">
                显示 1-4 条，共 1,456 条用户记录
            </div>
            <div class="flex gap-2">
                <button class="px-3 py-2 border border-gray-300 rounded-lg text-sm hover:bg-gray-50">上一页</button>
                <button class="px-3 py-2 bg-purple-600 text-white rounded-lg text-sm">1</button>
                <button class="px-3 py-2 border border-gray-300 rounded-lg text-sm hover:bg-gray-50">2</button>
                <button class="px-3 py-2 border border-gray-300 rounded-lg text-sm hover:bg-gray-50">3</button>
                <button class="px-3 py-2 border border-gray-300 rounded-lg text-sm hover:bg-gray-50">下一页</button>
            </div>
        </div>
    </div>

    <!-- 用户详情模态框 -->
    <div class="modal-overlay" id="userDetailModal">
        <div class="modal-content">
            <div class="p-6">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-lg font-bold text-gray-800">用户详细信息</h3>
                    <button onclick="closeModal('userDetailModal')" class="text-gray-400 hover:text-gray-600">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                
                <div class="space-y-6" id="userDetailContent">
                    <!-- 动态插入用户详情内容 -->
                </div>
            </div>
        </div>
    </div>

    <!-- 帮助完善信息模态框 -->
    <div class="modal-overlay" id="helpInfoModal">
        <div class="modal-content">
            <div class="p-6">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-lg font-bold text-gray-800">帮助用户完善信息</h3>
                    <button onclick="closeModal('helpInfoModal')" class="text-gray-400 hover:text-gray-600">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">作物详细信息</label>
                    <div class="grid grid-cols-2 gap-4">
                        <input type="text" class="p-3 border border-gray-300 rounded-lg" placeholder="作物品种" id="cropVariety">
                        <input type="text" class="p-3 border border-gray-300 rounded-lg" placeholder="种植面积（亩）" id="cropArea">
                        <input type="text" class="p-3 border border-gray-300 rounded-lg" placeholder="种植方式" id="cropMethod">
                        <input type="text" class="p-3 border border-gray-300 rounded-lg" placeholder="预计收获时间" id="harvestTime">
                    </div>
                </div>
                
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">联系信息</label>
                    <div class="grid grid-cols-2 gap-4">
                        <input type="text" class="p-3 border border-gray-300 rounded-lg" placeholder="详细地址" id="detailAddress">
                        <input type="text" class="p-3 border border-gray-300 rounded-lg" placeholder="备用联系方式" id="backupPhone">
                    </div>
                </div>
                
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">备注说明</label>
                    <textarea class="w-full p-3 border border-gray-300 rounded-lg" 
                              rows="3" 
                              placeholder="记录与用户沟通的情况，补充的信息说明等..."
                              id="adminNotes"></textarea>
                </div>
                
                <div class="mb-6 bg-blue-50 p-4 rounded-lg">
                    <h5 class="font-medium text-blue-800 mb-2">操作提醒</h5>
                    <ul class="text-sm text-blue-700 space-y-1">
                        <li>• 帮助补充信息前建议先电话沟通确认</li>
                        <li>• 所有操作将记录在用户档案和操作日志中</li>
                        <li>• 补充完成后系统会自动通知用户</li>
                    </ul>
                </div>
                
                <div class="flex gap-3">
                    <button class="flex-1 action-btn btn-edit" onclick="confirmHelpComplete()">
                        确认补充
                    </button>
                    <button class="flex-1 action-btn btn-call" onclick="callBeforeHelp()">
                        先电话沟通
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentUser = null;

        // 打电话给用户
        function callUser(userName, phone, purpose) {
            const purposes = {
                support: '技术支持',
                guide: '使用指导', 
                routine: '常规回访',
                reactivate: '重新激活'
            };
            
            const purposeText = purposes[purpose] || '用户沟通';
            
            if (confirm(`确定要拨打电话给${userName}（${phone}）进行${purposeText}吗？`)) {
                // 显示通话指导
                showCallGuidance(userName, phone, purpose);
            }
        }

        // 显示通话指导
        function showCallGuidance(userName, phone, purpose) {
            let guidance = '';
            switch(purpose) {
                case 'support':
                    guidance = `
                        通话要点：
                        1. 自我介绍：您好，我是智慧农业溯源平台的客服
                        2. 了解问题：请详细了解用户遇到的具体困难
                        3. 耐心指导：用通俗易懂的语言逐步指导操作
                        4. 确认解决：确保用户问题得到完全解决
                        5. 后续跟踪：告知用户如有问题随时联系
                    `;
                    break;
                case 'guide':
                    guidance = `
                        通话要点：
                        1. 欢迎新用户：欢迎使用我们的平台
                        2. 功能介绍：简单介绍主要功能和操作流程
                        3. 使用指导：重点指导如何发布第一条记录
                        4. 答疑解惑：解答用户关心的问题
                        5. 建立信任：让用户感受到专业和贴心的服务
                    `;
                    break;
                case 'routine':
                    guidance = `
                        通话要点：
                        1. 关怀问候：询问近期使用情况和作物生长状况
                        2. 收集反馈：了解平台使用体验和改进建议
                        3. 提供帮助：询问是否需要任何协助
                        4. 表达感谢：感谢用户对平台的支持
                    `;
                    break;
                case 'reactivate':
                    guidance = `
                        通话要点：
                        1. 关心询问：了解用户最近的情况
                        2. 了解原因：询问停止使用的原因
                        3. 解决问题：针对性地解决用户遇到的困难
                        4. 重新激活：鼓励用户继续使用平台
                        5. 持续关注：承诺会持续关注和帮助
                    `;
                    break;
            }
            
            alert(`正在为您拨打电话：${phone}\n\n${guidance}\n\n注意：请记录通话结果和后续跟进事项`);
            
            // 记录通话日志
            logCallAction(userName, phone, purpose);
        }

        // 记录通话操作
        function logCallAction(userName, phone, purpose) {
            const purposes = {
                support: '技术支持通话',
                guide: '新用户指导通话', 
                routine: '常规回访通话',
                reactivate: '用户激活通话'
            };
            
            console.log(`通话记录：${userName} - ${purposes[purpose]}`);
            
            // 实际应用中这里会更新UI和数据库
            setTimeout(() => {
                alert(`通话完成，请记录通话结果：\n- 通话时长\n- 问题解决情况\n- 后续跟进事项`);
            }, 2000);
        }

        // 帮助完善信息
        function helpCompleteInfo(userName) {
            currentUser = userName;
            
            // 预填充一些示例数据
            if (userName === '王大叔') {
                document.getElementById('cropVariety').value = '甜玉米（黄金品种）';
                document.getElementById('cropArea').value = '5';
                document.getElementById('cropMethod').value = '有机种植';
                document.getElementById('harvestTime').value = '2024年8月中旬';
                document.getElementById('detailAddress').value = '河北省保定市XX县XX村';
                document.getElementById('backupPhone').value = '';
                document.getElementById('adminNotes').value = '用户求助上传照片问题，电话沟通后了解到基本信息';
            }
            
            document.getElementById('helpInfoModal').classList.add('show');
        }

        // 确认帮助完善
        function confirmHelpComplete() {
            const cropInfo = {
                variety: document.getElementById('cropVariety').value,
                area: document.getElementById('cropArea').value,
                method: document.getElementById('cropMethod').value,
                harvestTime: document.getElementById('harvestTime').value,
                address: document.getElementById('detailAddress').value,
                backupPhone: document.getElementById('backupPhone').value,
                notes: document.getElementById('adminNotes').value
            };
            
            if (!cropInfo.variety || !cropInfo.area) {
                alert('请至少填写作物品种和种植面积');
                return;
            }
            
            alert(`已为用户${currentUser}补充信息：\n品种：${cropInfo.variety}\n面积：${cropInfo.area}亩\n方式：${cropInfo.method}\n\n用户会收到信息更新通知`);
            closeModal('helpInfoModal');
            
            // 记录操作日志
            logHelpAction(currentUser, cropInfo);
        }

        // 先电话沟通
        function callBeforeHelp() {
            closeModal('helpInfoModal');
            callUser(currentUser, '138****8888', 'support');
        }

        // 记录帮助操作
        function logHelpAction(userName, cropInfo) {
            console.log(`帮助完善：${userName}`, cropInfo);
        }

        // 查看用户详情
        function viewUserDetail(userName) {
            const userDetails = {
                '王大叔': {
                    name: '王大叔',
                    phone: '138****8888',
                    region: '河北省保定市',
                    registerDate: '2024-03-15',
                    lastActive: '2小时前',
                    status: '需要支持',
                    crops: ['甜玉米'],
                    area: '5亩',
                    records: 5,
                    followers: 156,
                    callHistory: [
                        { date: '2024-07-20', purpose: '技术支持', result: '问题解决' },
                        { date: '2024-07-15', purpose: '使用指导', result: '需要继续跟进' }
                    ]
                },
                '张大爷': {
                    name: '张大爷', 
                    phone: '138****6666',
                    region: '江苏省扬州市',
                    registerDate: '2024-02-10',
                    lastActive: '30分钟前',
                    status: '活跃',
                    crops: ['优质水稻'],
                    area: '15亩',
                    records: 12,
                    followers: 1200,
                    callHistory: [
                        { date: '2024-07-15', purpose: '常规回访', result: '使用良好' },
                        { date: '2024-06-30', purpose: '使用指导', result: '已掌握全部功能' }
                    ]
                }
            };
            
            const user = userDetails[userName];
            if (!user) return;
            
            const detailContent = document.getElementById('userDetailContent');
            detailContent.innerHTML = `
                <div class="bg-gray-50 p-4 rounded-lg">
                    <h4 class="font-bold text-gray-800 mb-3">基本信息</h4>
                    <div class="grid grid-cols-2 gap-4 text-sm">
                        <div>姓名：${user.name}</div>
                        <div>电话：${user.phone}</div>
                        <div>地区：${user.region}</div>
                        <div>注册：${user.registerDate}</div>
                        <div>状态：${user.status}</div>
                        <div>最后活跃：${user.lastActive}</div>
                    </div>
                </div>
                
                <div class="bg-green-50 p-4 rounded-lg">
                    <h4 class="font-bold text-gray-800 mb-3">作物信息</h4>
                    <div class="text-sm space-y-2">
                        <div>种植作物：${user.crops.join('、')}</div>
                        <div>种植面积：${user.area}</div>
                        <div>发布记录：${user.records}条</div>
                        <div>关注人数：${user.followers}人</div>
                    </div>
                </div>
                
                <div class="bg-blue-50 p-4 rounded-lg">
                    <h4 class="font-bold text-gray-800 mb-3">通话记录</h4>
                    <div class="space-y-2">
                        ${user.callHistory.map(call => `
                            <div class="text-sm border-l-2 border-blue-300 pl-3">
                                <div class="font-medium">${call.date} - ${call.purpose}</div>
                                <div class="text-gray-600">${call.result}</div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
            
            document.getElementById('userDetailModal').classList.add('show');
        }

        // 发送短信提醒
        function sendSMSReminder(userName) {
            const smsContent = `
                您好！最近好久没看到您的作物生长记录了，
                是不是遇到了什么困难？如果需要帮助，
                可以打电话400-888-9999，我们来协助您。
            `;
            
            if (confirm(`确定要给${userName}发送短信提醒吗？\n\n短信内容：${smsContent}`)) {
                alert('短信提醒已发送！');
            }
        }

        // 暂停用户账户
        function deactivateUser(userName) {
            if (confirm(`确定要暂停${userName}的账户吗？\n\n暂停后用户无法登录，但数据会保留。`)) {
                alert(`${userName}的账户已暂停`);
            }
        }

        // 导出用户列表
        function exportUsers() {
            alert('正在准备用户列表导出文件...\n\n文件将包含：\n- 用户基本信息\n- 作物信息\n- 活跃状态\n- 联系记录');
        }

        // 筛选功能
        function filterUsers(status) {
            console.log('筛选用户状态：', status);
        }

        function filterByRegion(region) {
            console.log('筛选地区：', region);
        }

        function searchUsers(keyword) {
            console.log('搜索用户：', keyword);
        }

        // 关闭模态框
        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('show');
        }

        // 切换标签页
        function switchTab(tab) {
            if (tab === 'content') {
                alert('切换到内容审核页面');
            } else if (tab === 'analytics') {
                alert('切换到数据统计页面');
            }
        }

        // 返回
        function goBack() {
            history.back();
        }

        // 退出登录
        function logout() {
            if (confirm('确定要退出登录吗？')) {
                alert('已退出登录');
            }
        }

        // 页面加载完成
        document.addEventListener('DOMContentLoaded', function() {
            console.log('用户管理页面已加载');
            
            // 模拟实时更新用户状态
            setInterval(function() {
                // 这里可以轮询获取用户状态更新
            }, 60000);
        });

        // 点击外部关闭模态框
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('modal-overlay')) {
                e.target.classList.remove('show');
            }
        });
    </script>
</body>
</html>